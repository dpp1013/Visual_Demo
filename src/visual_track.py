'''
可视化热带气旋轨迹
时间：20200824
'''
import numpy as np
import matplotlib.pyplot as plt
import cartopy.crs as ccrs
import cartopy.feature as cfeature
from cartopy.mpl.ticker import LongitudeFormatter, LatitudeFormatter

box = [110, 140, 10,45]
scale = '50m'
xstep, ystep = 10, 10
fig = plt.figure(figsize=(8, 10))
ax = plt.axes(projection=ccrs.PlateCarree())
# set_extent需要配置相应的crs，否则出来的地图范围不准确
ax.set_extent(box, crs=ccrs.PlateCarree())
land = cfeature.NaturalEarthFeature('physical', 'land', scale, edgecolor='face',
                                    facecolor=cfeature.COLORS['land'])
ax.add_feature(land, facecolor='0.75')
ax.coastlines(scale)
ax.stock_img()
# ===================================================
# 画轨迹
a1 = np.array([[21.4, 125.899994], [21.4, 125.899994], [21.108749, 125.828735], [21.108749, 125.828735],
          [20.75, 125.799988], [20.75, 125.799988], [20.286251, 125.838745], [20.286251, 125.838745],
          [19.800001, 125.899994], [19.800001, 125.899994], [19.35125, 125.943756], [19, 125.950012],
          [19, 125.950012], [18.818501, 125.90799], [18.818501, 125.90799], [18.700001, 125.799988],
          [18.700001, 125.799988], [18.510252, 125.620758], [18.510252, 125.620758], [18.320002, 125.410004],
          [18.320002, 125.410004], [18.163586, 125.217346], [18.163586, 125.217346], [18.016668, 125.050018],
          [18.016668, 125.050018], [17.844959, 124.916321], [17.700001, 124.828552], [17.700001, 124.828552],
          [17.61375, 124.787048], [17.61375, 124.787048], [17.575001, 124.774994], [17.575001, 124.774994],
          [17.559999, 124.765991], [17.559999, 124.765991], [17.574999, 124.75], [17.574999, 124.75],
          [17.59, 124.68689], [17.59, 124.68689], [17.650002, 124.649994], [17.650002, 124.649994],
          [17.950001, 124.799988], [17.950001, 124.799988], [18.16375, 124.856873], [18.16375, 124.856873],
          [18.4, 124.924988], [18.4, 124.924988], [18.610001, 125.037506], [18.610001, 125.037506],
          [18.85, 125.149994], [18.85, 125.149994], [19.158125, 125.220001], [19.5, 125.275024], [19.5, 125.275024],
          [19.81875, 125.346863], [20.175001, 125.399994], [20.175001, 125.399994], [20.625, 125.422485],
          [20.625, 125.422485], [21.074999, 125.399994], [21.074999, 125.399994], [21.453749, 125.331238],
          [21.453749, 125.331238], [21.75, 125.225006], [21.75, 125.225006], [22.099998, 124.975006],
          [22.099998, 124.975006], [22.229374, 124.785645], [22.324999, 124.600006], [22.324999, 124.600006],
          [22.400625, 124.472504], [22.400625, 124.472504], [22.450001, 124.375], [22.450001, 124.375],
          [22.4825, 124.293121], [22.4825, 124.293121], [22.5, 124.200012], [22.5, 124.200012],
          [22.514376, 124.057495], [22.525, 123.899994], [22.525, 123.899994], [22.549999, 123.625],
          [22.549999, 123.625], [22.598125, 123.428131], [22.598125, 123.428131], [22.650002, 123.174988],
          [22.650002, 123.174988], [22.703127, 122.902496], [22.703127, 122.902496], [22.700001, 122.524994],
          [22.700001, 122.524994], [22.425001, 121.375], [22.425001, 121.375], [22.271875, 120.9375],
          [22.174999, 120.575012], [22.174999, 120.575012], [22.195, 120.221863], [22.195, 120.221863],
          [22.275002, 119.924988], [22.275002, 119.924988], [22.355627, 119.70874], [22.355627, 119.70874],
          [22.425001, 119.5], [22.425001, 119.5], [22.450001, 118.899994], [22.450001, 118.899994],
          [22.450001, 118.350006], [22.450001, 118.350006], [22.390625, 118.084381], [22.390625, 118.084381],
          [22.274998, 117.799988], [22.274998, 117.799988], [22.113749, 117.449371], [22.113749, 117.449371],
          [21.9, 117.125], [21.9, 117.125], [21.375, 116.75], [21.375, 116.75], [21.175625, 116.748749],
          [21.025, 116.799988], [21.025, 116.799988], [20.91375, 116.772491], [20.91375, 116.772491],
          [20.824999, 116.774994], [20.824999, 116.774994], [20.721249, 116.862488], [20.721249, 116.862488],
          [20.625, 117.024994], [20.625, 117.024994], [20.540625, 117.236267], [20.475, 117.5], [20.475, 117.5],
          [20.4, 118.100006], [20.4, 118.100006], [20.556875, 118.430603], [20.556875, 118.430603],
          [20.799999, 118.825012], [20.799999, 118.825012], [21.0425, 119.311249], [21.0425, 119.311249],
          [21.299999, 119.850006], [21.299999, 119.850006], [21.510624, 120.387512], [21.799999, 120.924988],
          [21.799999, 120.924988], [22.261875, 121.44873], [22.825001, 121.950012], [22.825001, 121.950012],
          [22.825001, 121.950012], [23.397501, 122.438751], [23.397501, 122.438751], [23.397501, 122.438751],
          [24, 122.875], [24, 122.875], [24, 122.875], [24.612499, 123.272491], [24.612499, 123.272491],
          [24.612499, 123.272491], [25.224998, 123.549988], [25.224998, 123.549988], [25.825624, 123.651886],
          [25.825624, 123.651886], [26.400002, 123.674988], [26.400002, 123.674988], [26.400002, 123.674988],
          [26.915627, 123.736877], [26.915627, 123.736877], [27.450001, 123.825012], [27.450001, 123.825012],
          [27.450001, 123.825012], [28.055, 123.9375], [28.055, 123.9375], [28.055, 123.9375], [28.75, 124.125],
          [28.75, 124.125], [28.75, 124.125], [29.5375, 124.44812], [29.5375, 124.44812], [29.5375, 124.44812],
          [30.400002, 124.775024], [31.297981, 124.892212], [32.200001, 125.100006], [32.200001, 125.100006],
          [33.03196, 125.638733], [33.03196, 125.638733], [33.876923, 126.353851], [33.876923, 126.353851],
          [34.871655, 127.086487], [34.871655, 127.086487], [35.763638, 127.854553], [35.763638, 127.854553],
          [36.292767, 128.606628], [36.292767, 128.606628], [36.755554, 129.344421], [38.200001, 130.75],
          [38.200001, 130.75], [38.397083, 131.089172], [38.397083, 131.089172], [38.400002, 131.299988],
          [38.400002, 131.299988], [38.478752, 131.589996], [38.478752, 131.589996], [38.549999, 131.850006],
          [38.549999, 131.850006], [38.598747, 132.0625], [38.598747, 132.0625], [38.699997, 132.200012],
          [39.200001, 132.25], [39.200001, 132.25], [39.338753, 132.287506], [39.338753, 132.287506],
          [39.400002, 132.350006], [39.400002, 132.350006]])
ny_lon, ny_lat = a1[:,0:1].flatten(),a1[:,1:2].flatten()
a2= np.array([[21.541931293098596, 125.61426457711276], [21.620220155694586, 125.6225157552722],
               [21.36125368598341, 125.7571565179358], [21.134977775740325, 125.70840170304386],
               [20.923893185489565, 125.54383175705192], [20.964232337819816, 125.69139881022087],
               [20.50645614582667, 125.53801306714783], [20.60568950138485, 125.61417890455895],
               [20.00998428637776, 125.70048234999287], [20.106942274198513, 125.88615633548368],
               [19.610453540157287, 125.9316977469386], [19.00035682159596, 125.86520652883088],
               [19.070843392299658, 125.72626692236197], [18.982560912596746, 125.66161338254919],
               [18.826868183272644, 125.79978713084174], [18.759790620869325, 125.6160039409293],
               [18.795359751422666, 125.68952797356877], [18.56986330582264, 125.60054215800129],
               [18.529707355546584, 125.55963656611299], [18.354226722538577, 125.22252660011776],
               [18.469604478503207, 125.20203269363], [18.246088437204513, 124.98483849668246],
               [18.22257617565718, 124.91668722119498], [18.038609972303888, 124.86306174600307],
               [18.083084088696058, 124.71712060533254], [18.011226695353614, 124.88747452865849],
               [17.858680894668986, 124.498919276156], [17.885544972496632, 124.65401004414468],
               [17.751388555313, 124.54209371530271], [17.865667959667615, 124.73446470028217],
               [17.622856431730575, 124.584225472103], [17.768383416379503, 124.69497705276811],
               [17.68126142468496, 124.59176235933232], [17.743224446674468, 124.4683340401285],
               [17.604411368985804, 124.59223824876973], [17.885194545876235, 124.74538998240494],
               [17.75974713827192, 124.47893973175641], [17.79010969285061, 124.52755649010622],
               [17.72622252970799, 124.61357498881641], [17.6695400175879, 124.526471031405],
               [17.967962038232887, 124.49885367521266], [18.09493609912757, 124.48094378010988],
               [18.417971149525396, 124.54849326326075], [18.317271992948356, 124.53366676310704],
               [18.44126544384231, 124.75436081127417], [18.450528549689672, 124.69693860210519],
               [18.877870282143466, 124.84983540336056], [18.79107355729941, 125.03503262356578],
               [19.103813879265005, 124.98271930926875], [19.075769749722223, 125.06433229441735],
               [19.258572521023325, 125.01351217349765], [19.647906528390518, 125.25398380659156],
               [19.57192801315897, 125.24484104733283], [19.866657336348858, 125.29241485381296],
               [20.351566500520992, 125.12233554638749], [20.21894792983146, 125.39858646665117],
               [20.882212232711137, 125.40723450511663], [20.702401740047716, 125.1667555463317],
               [21.259400872099526, 125.33056538650833], [21.302825293988096, 125.159311180758],
               [21.609776643260346, 125.20335579199914], [21.613083916285845, 125.10772296245946],
               [21.950802750835564, 124.95901338808248], [22.061828312467433, 124.94316577024887],
               [22.348973919763, 124.69086308009885], [22.275610201533382, 124.67314723520191],
               [22.519211681476218, 124.5167689446117], [22.427739158019563, 124.34746720378142],
               [22.500578268413374, 124.29768404902963], [22.60317786102649, 124.29085497386252],
               [22.437264753361227, 124.32836671896699], [22.63559469067584, 124.33558630057324],
               [22.617842438048513, 124.3459904986701], [22.727543442944405, 124.1304657246188],
               [22.810605341000535, 124.212082007618], [22.517101350761518, 123.98731532669515],
               [22.78217592089584, 124.17815056478064], [22.60971955516632, 124.057181443051],
               [22.630403598145104, 123.69418088484538], [22.612006455329457, 123.80170519044098],
               [22.85549784377829, 123.3349309481116], [22.718569462587052, 123.43691948545771],
               [22.639059441815743, 123.16163993175506], [22.844993869849965, 123.09615224000235],
               [22.70970812575941, 122.95597498421513], [22.870618933427988, 122.91528557049276],
               [22.85484023506233, 122.8193052418381], [22.992113601594863, 122.83499734421405],
               [22.78657024124396, 122.26438058144072], [22.824490848900723, 122.35420286035037],
               [22.46282811830117, 121.0538004150435], [22.43734850577347, 121.34852891102004],
               [22.602093179202004, 120.61937794327916], [22.454462863845855, 120.45957387336203],
               [22.281100048859233, 120.41677563801933], [22.327513212727133, 120.02150431583625],
               [22.319630121471803, 119.8934719279262], [22.33149766367567, 119.66649685972189],
               [22.311266359126087, 119.78915928319782], [22.520706449229824, 119.66494845205195],
               [22.416668781266925, 119.46573165130164], [22.754259968612853, 119.34326026254321],
               [22.58951903204642, 119.17648939264826], [22.509556975792847, 118.62429970428084],
               [22.521074365887063, 118.59681271540472], [22.566345642122716, 118.3448575604885],
               [22.611166274577712, 118.04878350516906], [22.577267222899835, 117.94809918266256],
               [22.42483188371832, 117.81172151789065], [22.46421458914534, 117.66886084996105],
               [22.50272847738384, 117.64339933503253], [22.310521055797174, 117.37653989577618],
               [22.34549071200577, 117.35461823191058], [22.025778895207978, 116.95040258329715],
               [22.23091182538526, 116.81831354145378], [21.477922231129288, 116.49362474166831],
               [21.663957166990325, 116.47134482024454], [21.359492604829672, 116.626842911692],
               [21.232578406386136, 116.54565773399544], [21.167059218211307, 116.73614124410642],
               [21.116323511017754, 116.45799809907675], [21.106525790834144, 116.44960747734298],
               [21.10275978099463, 116.70369880199766], [20.884453161239843, 116.60886231162723],
               [20.99951683039258, 116.83639782418201], [20.831657921850148, 116.80634259293781],
               [20.70775206721425, 116.80345131945509], [20.887859132860903, 116.87260288523406],
               [20.57023241701691, 116.96664897315914], [20.51693677272134, 117.42738750687398],
               [20.658716551447508, 117.47101372817727], [20.41882690937846, 118.0695999016033],
               [20.501094883141818, 117.87943861722127], [20.72905487891283, 118.20316287925569],
               [20.802479333293917, 118.26040490465523], [20.93195271726114, 118.55739330653209],
               [21.031673566278577, 118.71698650847415], [21.05452075724827, 119.29600701902224],
               [21.333878956071313, 119.21616920438737], [21.520719223063598, 119.61497616101833],
               [21.434061567574606, 119.8483013457355], [21.6809508549359, 120.08179738841952],
               [21.883460407716356, 120.90337930157222], [22.103380788352784, 120.60527614191085],
               [22.44601410657616, 121.40352624903599], [22.880242411139943, 121.78335461734834],
               [22.935100177901933, 121.85031512944012], [23.103106170821846, 121.93764556199984],
               [23.460850802878458, 122.41925431351633], [23.709369059463402, 122.14736791631088],
               [23.681306724744847, 122.12263897863309], [24.19953715715746, 122.56343186481155],
               [24.10277333398029, 122.7782377252875], [24.160351715494247, 122.82142327859947],
               [24.637030915175465, 123.09288398923364], [24.688726967307012, 123.2077602389961],
               [24.700811516454806, 123.11763086578485], [25.32134048867837, 123.54900686602112],
               [25.300235828104647, 123.38549393030063], [25.830240541553135, 123.47643158995551],
               [26.14727857213432, 123.5150865612124], [26.505987555527323, 123.65003281895122],
               [26.48506735940018, 123.4350871348998], [26.42252722431301, 123.50356344604234],
               [27.067625686866258, 123.73131622414351], [27.204122063590237, 123.58356397259821],
               [27.535362197834903, 123.68723887172145], [27.76084467535433, 123.72442568171489],
               [27.58156607750715, 123.65078079597184], [28.365653574457788, 123.63814908715648],
               [28.340626338767322, 123.89193005424748], [28.176092390749968, 123.77010170256024],
               [28.941019888493862, 124.03879347132205], [29.06214728656497, 123.94483678534249],
               [28.750564820459164, 124.00863542360284], [29.776593327727994, 124.27083458719774],
               [29.577270221197214, 124.23694867243728], [29.688366687142764, 124.18816683321987],
               [30.550699756328584, 124.62092739411966], [31.523078735061667, 124.83010263102383],
               [32.414625185798734, 124.84848177730203], [32.50058610627819, 125.0596422121266],
               [33.307345863581055, 125.3741321330697], [33.07143175174245, 125.3205188387312],
               [34.09911630409796, 126.11496969734662], [34.202436331814745, 126.0283884150968],
               [34.96573757335848, 127.05146405979588], [35.04756027656016, 126.90599050664962],
               [35.86593995039084, 127.54177679602608], [35.96112600417426, 127.826997343899],
               [36.53870272594049, 128.48115881131713], [36.35377466738771, 128.35449717459576],
               [36.8873890984568, 129.05758109309673], [38.43522599625706, 130.54025610892782],
               [38.25102886181064, 130.42633368857025], [38.4222147303686, 131.0043402732697],
               [38.537425124468555, 130.86695226150385], [38.44210680075828, 131.24915105231003],
               [38.57602526508651, 131.06943021474765], [38.786521831874396, 131.31038224297706],
               [38.78797729462628, 131.37168144734815], [38.77845388022442, 131.58062838249023],
               [38.76245972064663, 131.5340700226175], [38.825082142979845, 131.76678021953973],
               [38.80368812850249, 131.810146932752], [38.81805890475565, 132.10753180340535],
               [39.33614398383368, 132.07172349713005], [39.27329981828971, 132.0371656113108],
               [39.38295627423585, 131.95704666912656], [39.352359149659186, 132.17927700411548],
               [39.50309104715733, 132.21123830651743], [39.436803875824346, 132.21710148661765]])
real_lon, real_lat = list(a1[:,0:1].flatten()),list(a1[:,1:2].flatten())
predicted_lon, predicted_lat = list(a2[:,0:1].flatten()),list(a2[:,1:2].flatten())

ax.plot(  real_lat ,real_lon,color='red', linewidth=1, marker='+',markersize='1',transform=ccrs.Geodetic(),label='Real value')
ax.plot( predicted_lat,predicted_lon,color='#FFFF99', linewidth=1, marker='*',markersize='1',transform=ccrs.Geodetic(),label = 'Predicted value')

# ax.plot(lat1,lon1,color='red', linewidth=2, marker='o',transform=ccrs.Geodetic(),)
ax.legend(loc='upper right')
#标注坐标轴
ax.set_xticks(np.arange(box[0], box[1]+xstep,xstep), crs=ccrs.PlateCarree())
ax.set_yticks(np.arange(box[2], box[3],ystep), crs=ccrs.PlateCarree())
# zero_direction_label用来设置经度的0度加不加E和W
lon_formatter = LongitudeFormatter(zero_direction_label=False)
lat_formatter = LatitudeFormatter()
ax.xaxis.set_major_formatter(lon_formatter)
ax.yaxis.set_major_formatter(lat_formatter)
# 添加网格线
ax.grid()
plt.show()